<!DOCTYPE html>
<html lang="en-us"><head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="generator" content="Hugo 0.55.6" />
	
	<title> | Ronald&#39;s Blog</title>
	
	
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp"
	 crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">
	<link href="/css/medium.css" rel="stylesheet">
	<link href="/css/additional.css" rel="stylesheet">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container pr-0">
        
        <a class="navbar-brand" href="https://ronaldbosma.github.io//">

            
            <span style="font-family:Righteous;">Ronald&#39;s Blog</span>
            
        </a>
        

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-controls="navbarSupportedContent"
            aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbarMediumish">
            
            <ul class="navbar-nav ml-auto">
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/blog">Blog</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/">About Me</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/index.xml">RSS</a>
                </li>
                
            </ul>
        </div>
        
    </div>
</nav>


        <div class="site-content">   
            <div class="container">
<div class="mainheading">
    <h1 class="sitetitle">Ronald&#39;s Blog</h1>
    <p class="lead">
         
    </p>
</div><div class="main-content">
        
        <div class="container">
            <div class="row">
                
                <div class="col-md-2 pl-0"><div class="share sticky-top sticky-top-offset">
    <p>Share</p>
    <ul>
        <li class="ml-1 mr-1">
        <a target="_blank" href="https://twitter.com/intent/tweet?text=&url=https%3a%2f%2fronaldbosma.github.io%2fpublications%2fvalkuilen-als-je-niet-tdd-doet%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=435');return false;">
        <i class="fab fa-twitter"></i>
        </a>
        </li>
        
        <li class="ml-1 mr-1">
        <a target="_blank" href="https://facebook.com/sharer.php?u=https%3a%2f%2fronaldbosma.github.io%2fpublications%2fvalkuilen-als-je-niet-tdd-doet%2f" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;">
        <i class="fab fa-facebook-f"></i>
        </a>
        </li>
        
        <li class="ml-1 mr-1">
        <a target="_blank" href="https://plus.google.com/share?url=https%3a%2f%2fronaldbosma.github.io%2fpublications%2fvalkuilen-als-je-niet-tdd-doet%2f" onclick="window.open(this.href, 'google-share', 'width=550,height=435');return false;">
        <i class="fab fa-google"></i>
        </a>
        </li>

        <li class="ml-1 mr-1">
        <a target="_blank" href="https://www.xing.com/spi/shares/new?url=https%3a%2f%2fronaldbosma.github.io%2fpublications%2fvalkuilen-als-je-niet-tdd-doet%2f" onclick="window.open(this.href, 'xing-share', 'width=550,height=435');return false;">
        <i class="fab fa-xing"></i>
        </a>
        </li>        
    </ul>

    
</div>
</div>
                                
                <div class="col-md-9 flex-first flex-md-unordered">
                    <div class="mainheading">
                        	
                        
                        
                        
                        <div class="row post-top-meta">
                            <div class="col-xs-12 col-md-3 col-lg-2 text-center text-md-left mb-4 mb-md-0 md-nopad-right">
                                <img class="author-thumb" src="/images/author.png" alt="Ronald Bosma">
                            </div>
                            <div class="col-xs-12 col-md-9 col-lg-10 text-center text-md-left md-nopad-left">
                                <a target="_blank" class="link-dark">Ronald Bosma</a><br>
                                <span class="author-description">
                                    Software engineer<br>
                                    <i class="far fa-star"></i>
                                    Jan 1, 0001
                                    <i class="far fa-clock clock"></i>
                                    7 min read
                                </span>					
                            </div>
                        </div>			
                        	
                        
                                                
                        
                        <h1 class="posttitle"></h1> 
                    </div>

                    
                    
                    
                    
                    
                    <div class="article-post">
                        

<h1 id="valkuilen-als-je-niet-tdd-doet">Valkuilen als je niet TDD doet</h1>

<p>In recente jaren is test automatisering steeds meer de norm geworden. Bedrijven moeten steeds sneller nieuwe software naar productie kunnen brengen waardoor vergaande automatisering nodig is. Bij test automatisering zie je 2 grote stromingen. Ontwikkelaars die hun testen schrijven na het implementeren van een nieuwe feature en ontwikkelaars die dit vooraf doen.</p>

<p>Het vooraf schrijven van testen is een techniek die Test Driven Development wordt genoemd. Deze techniek stelt je in staat stelt om code van hoge kwaliteit te schrijven.</p>

<p>De gedachte achter TDD is dat je eerst een test schrijf voordat je het bijgehorende stukje code schrijft dat door de test wordt gevalideerd. Deze test voer je uit en zal falen omdat de code nog niet is geïmplementeerd. De test is dan rood.</p>

<p>Nadat de test is gefaald is het tijd om de bijbehorende code te schrijven. Als hierna opnieuw de test wordt uitgevoerd zal deze moeten slagen en is hij groen.</p>

<p>Nu de test groen is heb je de mogelijkheid om de code te refactoren om de codekwaliteit te verbeteren waarbij je met de test kunt verifiëren dat de code nog werkt zoals verwacht. Deze cyclus wordt ook wel Red, Green, Refactor cylus genoemd.</p>

<p><img src="../../static/images/valkuilen-als-je-niet-TDD-doet.png" alt="Red, Green, Refactory" /></p>

<p>Deze cyclus wordt herhaalt totdat de volledige feature is geïmplementeerd. Het resultaat is een stuk code dat geautomatiseerd wordt gecontroleerd en een testdekking heeft van nagenoeg 100%.</p>

<p>Zelf schrijf ik al jaren op deze manier software. Het helpt mij om gefocust te werken aan de code die ik moet schrijven. Elke test is een requirement waar de code aan moet voldoen. Hierdoor kan ik stap voor stap een nieuwe feature schrijven en heb ik aan het eind code waarvan ik zeker weet dat hij doet wat hij moet doen.</p>

<p>Op het internet en in bladen wordt al jaren veel geschreven over TDD. Vaak over hoe het toegepast kan worden en de bovengenoemde voordelen die men ervaart. Het leek mij daarom interessant om TDD is vanuit een andere invalkshoek te bekijken en te kijken tegen welke valkuilen je aan kunt lopen wanneer je niet TDD toepast. Deze valkuilen komen voort uit ervaringen die ik in de praktijk tegen ben gekomen op de verschillende projecten die ik heb gedaan en code waar ik aan heb mogen werken.</p>

<h3 id="valkuil-1-testen-die-niets-testen">Valkuil 1: testen die niets testen</h3>

<p>Eén van de grootste valkuilen waar je in kunt trappen wanneer je testen achteraf schrijft is het schrijven van testen die niets testen. Ik heb meer dan eens een test geschreven die meteen groen ondanks dat de te testen code nog niet geïmplementeerd was. Een goede indicatie dat er iets mis is met je test. Bij TDD krijg je dus snel feedback als je een foutje hebt gemaakt.</p>

<p>Wanneer je testen achteraf schrijft wordt de stap dat de test eerst faalt overgeslagen. De test kan daarom altijd groen zijn. Ook als er een fout in zit.
Neem onderstaande code als voorbeeld. Hierin wordt gecontroleerd dat wanneer een rekeningnummer wordt opgegegeven ook de tenaamstelling gevuld moet zijn. Wanneer het rekeningnummer leeg is hoeft de tenaamstelling niet gevuld te zijn.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">bool</span> IsTenaamstellingCorrect(<span style="color:#66d9ef">string</span> rekeningnummer, <span style="color:#66d9ef">string</span> tenaamstelling)
{
    <span style="color:#66d9ef">if</span> (rekeningnummer != <span style="color:#66d9ef">null</span>)
    {
        <span style="color:#66d9ef">return</span> (tenaamstelling != <span style="color:#66d9ef">null</span>);
    }

    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
}
</code></pre></div>
<p>De bijehorende test voor het laatste scenario ziet er als volgt uit.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#a6e22e">[TestMethod]</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> IsTenaamstellingCorrect_Geeft_True_Terug_Indien_Rekeningnummer_Leeg_Is()
{
    <span style="color:#66d9ef">bool</span> resultaat = IsTenaamstellingCorrect(<span style="color:#66d9ef">null</span>, <span style="color:#e6db74">&#34;J. Jansen&#34;</span>);
    Assert.IsTrue(resultaat);
}
</code></pre></div>
<p>Het probleem met deze test is dat wanneer de controle rekeningnummer != null wordt weggehaald de test nog steeds zal slagen. Dit is echter niet de bedoeling.</p>

<p>In dit voorbeeld is het scenario onvolledig getest. De test zou eigenlijk moeten controleren dat true wordt teruggegeven als zowel rekeningnummer als tenaamstelling leeg is.</p>

<p>Hoewel dit een simpel voorbeeld is die je misschien snel ziet kom ik vergelijkbare situaties geregeld tegen tijdens het uitvoeren van code reviews. Wanneer TDD toegepast wordt zouden dit soort fouten eerder gevonden worden.</p>

<h3 id="valkuil-2-code-is-slecht-testbaar">Valkuil 2: code is slecht testbaar</h3>

<p>Wanneer testen achteraf geschreven worden wordt eerst volop gefocust op de werking van de nieuw te schrijven feature. Hierbij wordt vaak niet stilgestaan bij de testbaarheid van de code. Als de code af is en daarna testen worden geschreven kom je er pas achter hoe lastig dit is en zul je moeten refactoren. Omdat je nog geen geautomatiseerde testen hebt om op terug te vallen wordt een stuk risicovoller.</p>

<p>Een situatie die ik in de praktijk nogal eens tegenkom is het gebruik van code uit libraries die niet testbaar zijn opgezet. Een voorbeeld hiervan uit de ASP.NET wereld is bijvoorbeeld het HttpContext object. Deze wordt door ASP.NET gevuld met gegevens en in code vaak als singleton gebruikt. Vanuit unit testen is het echter vaak erg lastig om deze te vullen op een manier zoals ASP.NET dit zou doen. Vaak wordt daarom een wrapper geschreven die je kunt stubben.</p>

<p>Bij het toepassen van TDD ben je vanaf begin af aan bezig met het testen van de code die je schrijft. Je loopt meteen tegen eventuele problemen aan en kan deze snel oplossen. Alle code die je daarna schrijft heeft hier weer voordeel van.</p>

<blockquote>
<p>Note: Moet ik hier wel HttpContext noemen. Misschien code voorbeeld gebruiken?</p>
</blockquote>

<h2 id="onvoldoende-testdekking">Onvoldoende testdekking</h2>

<p>Naast de focus die TDD legt op de te implementeren functionaliteit door test voor test te werk te gaan is een van de andere grote voordelen de hoge mate van testdekking (ook wel code coverage genoemd). Doordat je eerst een test schrijft en pas daarna de bijgehorende code is het relatief simpel om een code coverage percentage van boven de 95% te halen.</p>

<p>Nu is code coverage geen doel op zich, maar hoe hoger het percentage, hoe meer vertrouwen je kunt hebben dat bij wijzigingen geen regressie optreedt. Hier moet ik wel bij zeggen dat de kwaliteit van je testen ook belangrijk is.</p>

<p>Als code coverage een doel opzich is worden er nog wel eens testen geschreven die alle code paden raken, maar vervolgens niets controleren. Om dit tegen te gaan kan een mutation testing framework ingezet worden. Een onderwerp op zich waar ik nu niet verder op in ga. Voor meer informatie kun je kunnen kijken op <a href="https://stryker-mutator.io/">https://stryker-mutator.io/</a>. Een open source tool dat door collega’s is geschreven en wordt onderhouden.</p>

<h3 id="valkuil-3-testen-worden-geschreven-op-basis-van-al-geïmplementeerde-code">Valkuil 3: testen worden geschreven op basis van al geïmplementeerde code</h3>

<p>Eén van de meest voorkomende valkuilen als het om onvoldoende testdekking gaat is dat testen worden geschreven op basis van de al bestaande code. Hierbij wordt een analyse gemaakt van de geschreven code en worden op basis daarvan scenario’s gekozen die geautomatiseerd worden getest. Hierbij wordt vaak niet nagedacht over alle requirements die mogelijk ook relevant zijn, maar niet zijn geïmplementeerd. Het code voorbeeld bij valkuil 1 is hier een mooi voorbeeld van.</p>

<p>Bij TDD werk je test voor test de verschillende requirements af die je moet implementeren. Hierdoor zie je dat veel meer van deze requirements worden geverifieerd door een test. Dit resulteert uiteindelijk in een betere testdekking.</p>

<h3 id="valkuil-4-het-schrijven-van-testen-wordt-afgeraffeld">Valkuil 4: het schrijven van testen wordt afgeraffeld</h3>

<p>Eén van de meest vervelende klusjes die ik in het verleden als ontwikkelaar heb mogen doen is het schrijven van testen voor de code die iemand anders heeft geschreven.</p>

<p>Ik zie het schrijven van nieuwe software is een creatief proces. En weinig klusjes in software ontwikkeling zijn minder creatief dan het schrijven van testen achteraf. Het creatieve proces van software schrijven is al voorbij en het enig wat nog gedaan moet worden is controleren dat het werkt.</p>

<p>Je ziet hierdoor dat de minimale set aan testen wordt geschreven zodat de code coverage richtlijn wordt gehaald. Voldoende testdekking van de relevante scenario’s krijg je hierdoor vaak niet.</p>

<p>Bij TDD wordt het schrijven van testen onderdeel van eht creatieve proces. Hierdoor blijf het werk continu interessant en is het geen naar klusje meer dat achteraf moet worden uitgevoerd.</p>

<h3 id="valkuil-5-testen-worden-helemaal-niet-geschreven">Valkuil 5: testen worden helemaal niet geschreven</h3>

<p>Als er druk op de ketel staat en testen worden achteraf geschreven zullen deze een van eerste slachtoffers zijn. Ze worden vaak uitgesteld om in een volgende sprint opgepakt te worden en later misschien nooit geschreven. Het risico op bugs zal hierdoor bij wijzigingen in de toekomst veel hoger zijn. Bij TDD zou dit nooit gebeuren.</p>

<p>Daarnaast bestaat vooral bij managers en projectleiders nog wel eens de illusie dat het überhaupt schrijven van testen alleen maar tijd kost. Mijn ervaring is dat TDD juist tijdwinst oplevert. Bij het bouwen van de functionaliteit wordt code niet alleen direct getest, maar ook vaak en snel. Met handmatig testen zou dit velen malen meer tijd kosten.</p>

<h2 id="conclusie">Conclusie</h2>

<p>TDD is een techniek die naar mijn menig iedere ontwikkelaar zou moeten beheersen. Omdat het denkproces net iets anders in elkaar steekt is het soms lastig om te starten. Maar als je deze techniek eenmaal onder de knie hebt kan het je veel voordelen opleveren.</p>

<p>TDD biedt een oplossing om verschillende valkuilen te vermijden. Zeker als kwaliteit en snelheid van belang zijn is test automatisering een must waarbij het onderste uit de kan kunt halen als je TDD toepast.</p>

                    </div>
                    
                    
                    <div class="after-post-tags">
                        <ul class="tags">
                        
                        </ul>
                    </div>
                    
                    
                    
                    <div class="row PageNavigation d-flex justify-content-between font-weight-bold">
                    
                    
                    <div class="clearfix"></div>
                    </div>
                    
                </div>
                
            </div>
        </div>
        
        
    </div>


            </div>
<div class="jumbotron fortags">
	<div class="d-md-flex h-100">
		<div class="col-md-4 transpdark align-self-center text-center h-100">
			<div class="d-md-flex align-items-center justify-content-center h-100">
				<h2 class="d-md-block d-none align-self-center py-1 font-weight-light">Explore <span class="d-none d-md-inline">→</span></h2>
			</div>
		</div>
		<div class="col-md-8 p-5 align-self-center text-center">
			
			<a class="mt-1 mb-1" href="/tags/azure-devops">azure-devops</a>
			
			<a class="mt-1 mb-1" href="/tags/azure-pipelines">azure-pipelines</a>
			
			<a class="mt-1 mb-1" href="/tags/cleaner-code">cleaner-code</a>
			
			<a class="mt-1 mb-1" href="/tags/continuous-integration">continuous-integration</a>
			
			<a class="mt-1 mb-1" href="/tags/hugo">hugo</a>
			
			<a class="mt-1 mb-1" href="/tags/test-automation">test-automation</a>
			
		</div>
	</div>
</div>

<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                &copy; Copyright Ronald Bosma - All rights reserved
            </div>
            <div class="col-md-6 col-sm-6 text-center text-lg-right">    
                <a target="_blank" href="https://www.wowthemes.net">Mediumish Theme</a> by WowThemes.net
            </div>
        </div>
    </div>
</footer>

        </div>


<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

<script src="/js/mediumish.js"></script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-136383708-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    </body>
</html>
